import{u as F,r as u,S as H}from"./index-Cv0MCJep.js";import{u as P}from"./index.esm-CtzVagC9.js";import{A as m}from"./CustomerServices-RCtKxH8V.js";import{a as b,n as y}from"./toast-DkhCIWt5.js";import{u as R}from"./useToggleDrawer-C1UtrQV4.js";import{u as U}from"./useTranslationValue-BxYdltS6.js";const N=a=>{const o=F(),{isDrawerOpen:w,closeDrawer:l,setIsUpdate:f,lang:v}=u.useContext(H),[c,p]=u.useState([]),[r,A]=u.useState("en"),[S,x]=u.useState({}),[_,D]=u.useState(!1),[I,i]=u.useState(!1),{setServiceId:g}=R(),{handlerTextTranslateHandler:T}=U();let C=[];(async()=>{for(let e=0;e<c.length;e++){const s=await T(c[e],r);C=[...C,{name:{[r]:c[e],...s}}]}})();const{handleSubmit:V,register:E,setValue:n,clearErrors:h,formState:{errors:O}}=P(),L=async e=>{try{i(!0);const s={name:(e==null?void 0:e.name)||"",placeholder:(e==null?void 0:e.placeholder)||"",field_type:(e==null?void 0:e.field_type)||"",field_type_data:(e==null?void 0:e.field_type_data)||"",is_required:(e==null?void 0:e.is_required)||"",css_class:(e==null?void 0:e.css_class)||"",extra_attr:(e==null?void 0:e.extra_attr)||"",default_value:(e==null?void 0:e.default_value)||"",status:(e==null?void 0:e.status)||0};if(console.log("attributeData",s),a){const t=await m.updateAttributes(a,s);f(!0),i(!1),y(t.message),l(),g()}else{const t=await m.addAttribute(s);f(!0),i(!1),y(t.message),l(),g()}}catch(s){b(s?s.response.data.message:s.message),l(),i(!1),g()}},j=async({name:e})=>{try{if(i(!0),a){const s=await m.updateChildAttributes({ids:o.pathname.split("/")[2],id:a},{name:{[r]:e},status:_?"show":"hide"});f(!0),i(!1),y(s.message),l()}else{const s=await m.addChildAttribute(o.pathname.split("/")[2],{name:{[r]:e},status:_?"show":"hide"});f(!0),i(!1),y(s.message),l()}}catch(s){b(s?s.response.data.message:s.message),l(),i(!1),g()}},q=e=>{A(e),Object.keys(S).length>0&&(n("title",S.title[e||"en"]),n("name",S.name[e||"en"]))},B=e=>{p([...c.filter((s,t)=>t!==e)])},k=e=>{e.preventDefault(),e.target.value!==""&&(p([...c,e.target.value]),e.target.value="")};return u.useEffect(()=>{if(!w){x({}),n("title"),n("name"),n("option"),h("title"),h("name"),h("option"),p([]),A(v),n("language",r);return}o.pathname==="/attributes"&&a?(async()=>{var e,s;try{const t=await m.getAttributeById(a);t&&(x(t),n("title",t.title[r||"en"]),n("name",t.name[r||"en"]),n("option",t.option))}catch(t){b(((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||(t==null?void 0:t.message))}})():o.pathname===`/attributes/${o.pathname.split("/")[2]}`&&(async()=>{var e,s;try{const t=await m.getChildAttributeById({id:o.pathname.split("/")[2],ids:a});t&&(n("name",t.name[r||"en"]),D(t.status==="show"))}catch(t){b(((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||(t==null?void 0:t.message))}})()},[h,a,w,n,o,r,v]),{handleSubmit:V,onSubmits:j,onSubmit:L,register:E,errors:O,variants:c,setVariants:p,addVariant:k,removeVariant:B,published:_,setPublished:D,isSubmitting:I,handleSelectLanguage:q}};export{N as u};
