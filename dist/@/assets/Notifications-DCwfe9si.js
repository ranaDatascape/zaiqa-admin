import{j as t,r,f as i,k as M}from"./index-Cv0MCJep.js";import{u as _,N as c,o as E,e as g,S as F,x as P}from"./Layout-D-JsJcP2.js";import{P as $}from"./PageTitle-CDKo5HT-.js";import{a as O,n as p}from"./toast-DkhCIWt5.js";import"./iconBase-CHzXLRSI.js";/* empty css                      */const y=({id:d,name:o,type:h,handleClick:x,isChecked:N})=>t.jsx("input",{id:d,name:o,type:h,onChange:x,checked:N}),J=()=>{const[d,o]=r.useState([]),[h,x]=r.useState(0),[N,l]=r.useState(0),[b,f]=r.useState(2),[n,m]=r.useState([]),[j,u]=r.useState(!1),{showDateTimeFormat:w}=_(),k=async s=>{try{await c.updateStatusNotification(s,{status:"read"});const e=await c.getAllNotification();o(e==null?void 0:e.notifications),l(e==null?void 0:e.totalUnreadDoc),window.location.reload(!1)}catch{}},C=async s=>{try{await c.deleteNotification(s);const e=await c.getAllNotification();o(e==null?void 0:e.notifications),l(e==null?void 0:e.totalUnreadDoc),x(e==null?void 0:e.totalDoc)}catch{}},D=async s=>{try{const e=await c.getAllNotification(s);o(a=>[...a,...e==null?void 0:e.notifications]),l(e==null?void 0:e.totalUnreadDoc),f(a=>a+1)}catch{}},S=async()=>{try{const s=await c.updateManyStatusNotification({ids:n,status:"read"});m([]),p(s.message),f(1);const e=await c.getAllNotification();o(e==null?void 0:e.notifications),l(e==null?void 0:e.totalUnreadDoc)}catch{}},T=async()=>{try{const s=await c.deleteManyNotification({ids:n});p(s.message),m([]),f(1);const e=await c.getAllNotification();o(e==null?void 0:e.notifications),l(e==null?void 0:e.totalUnreadDoc)}catch{}},U=()=>{u(!j),m(d==null?void 0:d.map(s=>s._id)),j&&m([])},B=s=>{const{id:e,checked:a}=s.target;m([...n,e]),a||m(n.filter(I=>I!==e))};return r.useEffect(()=>{(async()=>{var s,e;try{const a=await c.getAllNotification();o(a==null?void 0:a.notifications),l(a==null?void 0:a.totalUnreadDoc),x(a==null?void 0:a.totalDoc),f(1)}catch(a){O(((e=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:e.message)||(a==null?void 0:a.message))}})()},[]),t.jsxs(t.Fragment,{children:[t.jsx($,{children:"Notifications"}),t.jsx(i.Card,{className:"shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:t.jsxs(i.CardBody,{className:"flex justify-between",children:[t.jsx("div",{className:"",children:t.jsxs(i.Button,{disabled:(n==null?void 0:n.length)<1,onClick:S,className:"w-full rounded-md h-10 flex items-center justify-center bg-blue-500 text-white px-1 hover:bg-blue-700",children:[t.jsx("span",{className:"mr-2",children:t.jsx(E,{})}),"Mark is read"]})}),t.jsx("div",{className:"",children:t.jsxs(i.Button,{disabled:(n==null?void 0:n.length)<1,onClick:T,className:"w-full rounded-md h-10 bg-red-500 btn-red",children:[t.jsx("span",{className:"mr-3",children:t.jsx(g,{})}),"Delete"]})})]})}),t.jsx(i.Card,{className:"shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:t.jsxs(i.CardBody,{style:{padding:0},children:[t.jsx("div",{className:"p-4 dark:text-gray-300",children:t.jsxs("p",{className:"text-sm font-semibold text-teal-700",children:["Unread Notification (",N,")"]})}),t.jsxs("div",{className:"border rounded-md",children:[t.jsxs("div",{className:"bg-gray-200 border-gray-400 p-2 dark:bg-gray-700 dark:text-gray-400 flex justify-between",children:[t.jsxs("div",{className:"flex",children:[t.jsx(y,{type:"checkbox",name:"selectAll",id:"selectAll",handleClick:U,isChecked:j}),t.jsx("p",{className:"text-xs font-semibold text-gray-500 my-auto dark:text-gray-300 ml-6 uppercase",children:"Notification"})]}),t.jsx("div",{className:"text-right",children:t.jsx("p",{className:"text-xs font-semibold text-gray-500 my-auto dark:text-gray-300 mr-2 uppercase",children:"Action"})})]}),t.jsx("div",{className:"w-full lg:h-lg md:h-sm h-md relative",children:t.jsx(F,{className:"scrollbar-hide",children:t.jsxs(i.TableContainer,{className:"border-none p-2",children:[t.jsx(i.Table,{children:t.jsx(i.TableBody,{className:"w-full h-440",children:d.map((s,e)=>t.jsxs(i.TableRow,{className:"border-none",children:[t.jsx(i.TableCell,{style:{padding:0},children:t.jsx(y,{type:"checkbox",name:s==null?void 0:s._id,id:s._id,handleClick:B,isChecked:n==null?void 0:n.includes(s._id)})}),t.jsx(i.TableCell,{className:"md:w-full w-1/5",style:{paddingRight:0},children:t.jsxs(M,{to:s.productId?`/product/${s.productId}`:`/order/${s.orderId}`,className:"flex items-center",onClick:()=>k(s._id),children:[t.jsx(i.Avatar,{className:"mr-2 md:block hidden bg-gray-50 border border-gray-200",src:s.image,alt:"image"}),t.jsxs("div",{className:"notification-content",children:[t.jsx("div",{className:"md:inline-block hidden",children:t.jsx("h6",{className:"font-medium text-gray-500",children:s==null?void 0:s.message})}),t.jsx("div",{className:"md:hidden",children:t.jsx("h6",{className:"font-medium text-gray-500",children:(s==null?void 0:s.message.substring(0,33))+"..."})}),t.jsxs("p",{className:"flex items-center text-xs text-gray-400",children:[s.productId?t.jsx(i.Badge,{type:"danger",children:"Stock Out"}):t.jsx(i.Badge,{type:"success",children:"New Order"}),t.jsx("span",{className:"ml-2",children:w(s==null?void 0:s.createdAt)})]})]}),s.status==="unread"&&t.jsx("span",{className:"px-2 md:flex hidden focus:outline-none text-emerald-600",children:t.jsx("img",{src:P,width:12,height:12,alt:"ellipse",className:"w-3 h-3 text-emerald-600"})})]})}),t.jsx(i.TableCell,{className:"text-right",style:{padding:`${window.innerWidth<420?"0":"0.5rem"}`},children:t.jsxs("div",{className:"group inline-block relative",children:[t.jsx("button",{onClick:()=>C(s._id),type:"button",className:"px-2 group-hover:text-blue-500 text-red-500 focus:outline-none",children:t.jsx(g,{})}),t.jsx("div",{className:"absolute hidden group-hover:inline-block bg-gray-50 dark:text-white mr-8 mb-1 right-0 z-50 px-3 py-2 text-sm font-medium text-red-600 rounded-lg shadow-sm tooltip dark:bg-gray-700",children:"Delete"})]})})]},e+1))})}),t.jsx("div",{children:h>5&&d.length!==h?t.jsx("div",{className:"text-center py-2",children:t.jsx("button",{onClick:()=>D(b+1),type:"button",className:"focus:outline-none text-blue-700 hover:underline transition ease-out duration-200 dark:text-gray-400",children:"See more notifications"})}):null})]})})})]})]})})]})};export{J as default};
