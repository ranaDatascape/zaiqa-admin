import{r as p,S as U,j as e,f as r}from"./index-Cv0MCJep.js";import{u as M}from"./useToggleDrawer-C1UtrQV4.js";import{D as q}from"./DeleteModal-BtvCN7mm.js";import{D as z,M as _}from"./MainDrawer-D7Kypkxo.js";import{S as O,u as V}from"./Layout-D-JsJcP2.js";import{a as w,n as k}from"./toast-DkhCIWt5.js";import{E as G}from"./Error-DhTYXBCu.js";import{I as Q}from"./InputArea-C4k6rcIG.js";import{L as u}from"./LabelArea-Bb7qUJrU.js";import{a as W,u as D}from"./useGetDatas-DUx7WE11.js";import{R as Z}from"./quill.snow-5yXoS7a5.js";import{u as $}from"./index.esm-CtzVagC9.js";import{a as H}from"./index.prod-dN6d4wYn.js";import{E as J}from"./EditDeleteButton-ie0-NJtD.js";const K=({refetchData:f})=>{const{data:o,isLoading:g}=W("/category/parent","parentCategory"),{closeDrawer:i}=p.useContext(U),n=D(),[x,d]=p.useState(null),[m,c]=p.useState(null),[N,h]=p.useState(""),[b,v]=p.useState(""),{register:s,handleSubmit:t,reset:I,setValue:T,formState:{errors:E,isSubmitting:F}}=$(),A=l=>{const a=l.target.files[0],j=5*1024*1024;if(a.size>j){w("Image size must be less than 5MB."),d(null),c(null);return}a&&(d(a),c(URL.createObjectURL(a)))},L=async()=>{if(!x)return h("Please select an image."),null;const l=new FormData;l.append("image",x);try{return(await n.post("/images/upload",l,{headers:{"Content-Type":"multipart/form-data"}})).data.imageUrl}catch(a){return console.error("Image upload failed:",a),h("Image upload failed."),null}},B=async l=>{var C;console.log(l);const a=await L();if(console.log(a),!a)return;const j={name:l.name,description:l.description,parentId:(l==null?void 0:l.parentId)||0,slug:(C=l.name)==null?void 0:C.toLowerCase().replace(/[^A-Z0-9]+/gi,"-"),image:a,image_thumb:a,status:l.status};console.log(j);try{(await n.post("/category/add",j)).status===200&&(k("Category created successfully."),I(),i(),c(null),d(null),f())}catch(S){console.error("Banner creation failed:",S)}},P={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{align:[]}],[{color:[]},{background:[]}],["blockquote","code-block"],["link","image","video"],["clean"],["custom-check"]]},R=["header","bold","italic","underline","strike","list","bullet","script","indent","align","color","background","blockquote","code-block","link","image","video"];return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("h1",{className:"text-4xl text-center mt-4",children:"Add Category"})}),e.jsx(O,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:t(B),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(u,{label:"Name"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Q,{required:!0,register:s,label:"Category title",name:"name",type:"text",placeholder:"Category Name"}),e.jsx(G,{errorName:E.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(u,{label:"Parent Category"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:g?e.jsx("p",{children:"Loading categories..."}):e.jsxs("select",{...s("parentId"),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Select a Category"}),o==null?void 0:o.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6",children:[e.jsx(u,{label:"Description"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 h-96 mb-5",children:[e.jsx(Z,{value:b,modules:P,formats:R,onChange:l=>{v(l),T("description",l)},placeholder:"Write something...",className:"h-[300px]"}),e.jsx("input",{type:"hidden",...s("description"),value:b})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(u,{label:"Images"}),e.jsx("div",{className:"col-span-6 sm:col-span-4",children:e.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"border border-gray-300 rounded-lg p-2 block w-full cursor-pointer"})}),m&&e.jsx("img",{src:m,alt:"Preview",className:"mt-2 w-32 h-32 object-cover rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(u,{label:"Status"}),e.jsx("div",{className:"col-span-6 sm:col-span-4",children:e.jsxs("select",{...s("status",{required:!0}),className:"border border-gray-300 rounded-lg p-2 block w-full bg-white",children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})})]})]}),e.jsx(z,{title:"Category",isSubmitting:F})]})})]})},X="http://localhost:5055/api",pe=({data:f,lang:o,refetch:g,isCheck:i,categories:n,useParamId:x})=>{const{title:d,serviceId:m,handleModalOpen:c,handleUpdate:N}=M(),{showingTranslateValue:h}=V(),b=D(),v=async s=>{try{(await b.put(`/category/status/${s}`)).status===200?(k("Status updated successfully!"),g()):w("Failed to update status.")}catch{w("Error updating status.")}};return e.jsxs(e.Fragment,{children:[(i==null?void 0:i.length)<1&&e.jsx(q,{useParamId:x,id:m,title:d}),e.jsx(_,{children:e.jsx(K,{id:m,data:f,lang:o})}),e.jsx(r.TableBody,{children:n==null?void 0:n.map(s=>{var t;return e.jsxs(r.TableRow,{children:[e.jsx(r.TableCell,{className:"font-semibold uppercase text-xs",children:s==null?void 0:s.id}),e.jsx(r.TableCell,{children:s!=null&&s.image?e.jsx(r.Avatar,{className:"hidden mr-3 md:block bg-gray-50 p-1",src:X+(s==null?void 0:s.image),alt:s==null?void 0:s.parent}):e.jsx(r.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(r.TableCell,{className:"text-sm",children:s==null?void 0:s.name}),e.jsx(r.TableCell,{className:"text-sm",children:((t=s==null?void 0:s.description)==null?void 0:t.length)>50?s.description.slice(0,50)+"...":s.description}),e.jsx(r.TableCell,{className:"text-center",children:e.jsx(H,{onChange:()=>v(s==null?void 0:s.id),checked:(s==null?void 0:s.status)===1,onColor:"#10B981",offColor:"#EF4444",uncheckedIcon:!1,checkedIcon:!1})}),e.jsx(r.TableCell,{children:e.jsx(J,{id:s==null?void 0:s.id,parent:s,isCheck:i,children:s==null?void 0:s.children,handleUpdate:N,handleModalOpen:c,title:h(s==null?void 0:s.name)})})]},s==null?void 0:s.id)})})]})};export{K as C,pe as a};
