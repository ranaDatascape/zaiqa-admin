import{r as u,u as oe,S as X,L as ne,j as e,f as T}from"./index-Cv0MCJep.js";import{R as ie}from"./index-LNM3yfuz.js";import{M as Q,T as W}from"./Tree-B5pXmuyD.js";import{a as ce}from"./MainDrawer-D7Kypkxo.js";import{u as Z,p as de,l as pe}from"./Layout-D-JsJcP2.js";import{E as D}from"./Error-DhTYXBCu.js";import{n as A,a as U}from"./toast-DkhCIWt5.js";import{T as ge}from"./Title-6CzNxVGl.js";import{L as c}from"./LabelArea-Bb7qUJrU.js";import{S as P}from"./SwitchToggle-CYdqVLVE.js";import{T as Y}from"./TextAreaCom-BOROZaGH.js";import{u as me}from"./index.esm-CtzVagC9.js";import{u as he}from"./useDisableForDemo-DndbcQrQ.js";import{C as ee,A as J}from"./CustomerServices-RCtKxH8V.js";import{C as ue}from"./CouponServices-Bwlwibye.js";import{C as xe}from"./CurrencyServices-BK8AbJu1.js";import{P as je}from"./ProductServices-8BRK73zt.js";import{u as fe}from"./useAsync-Dx79ITIc.js";const be=(x,d="en",k)=>{const[v,_]=u.useState(""),[N,f]=u.useState([]),m=oe(),[F,E]=u.useState(""),[p,R]=u.useState(!0),[O,a]=u.useState(!0),[l,r]=u.useState([]),[t,b]=u.useState([]),[M,$]=u.useState(!1),[H,S]=u.useState(""),{isBulkDrawerOpen:V,closeBulkDrawer:w,setIsUpdate:C}=u.useContext(X),{handleDisableForDemo:z}=he(),{register:L,handleSubmit:G,watch:I,setValue:n,clearErrors:o,formState:{errors:q}}=me(),K=async s=>{var j,y,i;if(!z())try{const h={ids:x,categories:l==null?void 0:l.map(g=>g._id),category:(j=t[0])==null?void 0:j._id,productType:[M?"food":"others"],show:s.show,status:p?"show":"hide",tag:JSON.stringify(N)},B={ids:x,status:p?"show":"hide"},se={ids:x,enabled:p?"show":"hide",live_exchange_rates:O?"show":"hide"},ae={ids:x,parentId:F,description:s.description,parentName:H,status:p?"show":"hide"},re={ids:x,option:s.option,status:p?"show":"hide"},te={ids:x,currentId:k,changeId:s.groupName,status:p?"show":"hide"},le={ids:x,startTime:s.startTime,endTime:s.endTime,status:p?"show":"hide"};if(m.pathname==="/products"){const g=await je.updateManyProducts(h);C(!0),A(g.message),w()}if(m.pathname==="/coupons"){const g=await ue.updateManyCoupons(le);C(!0),A(g.message),w()}if(m.pathname==="/languages"){const g=await ne.updateManyLanguage(B);C(!0),A(g.message),w()}if(m.pathname==="/currencies"){const g=await xe.updateManyCurrencies(se);C(!0),A(g.message),w()}if(m.pathname==="/categories"||m.pathname===`/categories/${k}`){const g=await ee.updateManyCategory(ae);C(!0),A(g.message),w()}if(m.pathname==="/attributes"){const g=await J.updateManyAttribute(re);C(!0),A(g.message),w()}if(m.pathname===`/attributes/${m.pathname.split("/")[2]}`){const g=await J.updateManyChildAttribute(te);C(!0),A(g.message),w()}}catch(h){U(((i=(y=h==null?void 0:h.response)==null?void 0:y.data)==null?void 0:i.message)||(h==null?void 0:h.message))}};return u.useEffect(()=>{if(!V){n("parent"),n("children"),n("type"),n("show"),n("name"),_(""),f([]),o("parent"),o("children"),o("type"),o("name"),n("name"),n("iso_code"),n("call_prefix"),n("currency"),n("zone"),o("name"),o("iso_code"),o("call_prefix"),o("currency"),o("zone"),o("status"),n("name"),n("iso_code"),n("country"),n("zone"),n("description"),o("name"),o("iso_code"),o("country"),o("zone"),o("status"),o("show"),o("description"),b([]),r([]);return}},[n,V,o]),u.useEffect(()=>{_(I("children"))},[I,v]),{register:L,watch:I,handleSubmit:G,onSubmit:K,errors:q,tag:N,setTag:f,published:p,setPublished:R,published2:O,setPublished2:a,checked:F,setChecked:E,selectedCategory:l,setSelectedCategory:r,defaultCategory:t,setDefaultCategory:b,selectCategoryName:H,setSelectCategoryName:S,isFoodItem:M,setIsFoodItem:$}},ye=({selectedCategory:x,setSelectedCategory:d,setDefaultCategory:k})=>{var O;const{data:v,loading:_}=fe((O=ee)==null?void 0:O.getAllCategory),{showingTranslateValue:N}=Z(),f=`
  .rc-tree-child-tree {
    display: block;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,m={motionName:"node-motion",motionAppear:!1,onAppearStart:a=>({height:0}),onAppearActive:a=>({height:a.scrollHeight}),onLeaveStart:a=>({height:a.offsetHeight}),onLeaveActive:()=>({height:0})},F=a=>{var r;let l=[];for(let t of a)l.push({title:N(t.name),key:t._id,children:((r=t==null?void 0:t.children)==null?void 0:r.length)>0&&F(t.children)});return l},E=(a,l)=>{var r;return a._id===l?a:(r=a==null?void 0:a.children)==null?void 0:r.reduce((t,b)=>t??E(b,l),void 0)},p=a=>{const l=v[0],r=E(l,a);if(r!==void 0){if(x.filter(b=>b._id===r._id).length!==0)return A("This category already selected!");d(b=>[...b,{_id:r==null?void 0:r._id,name:N(r==null?void 0:r.name)}]),k(()=>[{_id:r==null?void 0:r._id,name:N(r==null?void 0:r.name)}])}},R=a=>{d(a)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-2",children:e.jsx(Q,{displayValue:"name",groupBy:"name",isObject:!0,hidePlaceholder:!0,onKeyPressFn:function(){},onRemove:a=>R(a),onSearch:function(){},onSelect:a=>p(a),selectedValues:x,placeholder:"Select Category"})}),!_&&v!==void 0&&e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:f}}),e.jsx(W,{expandAction:"click",treeData:F(v),onSelect:a=>p(a[0]),motion:m,animation:"slide-up"})]})]})},Be=({ids:x,title:d,lang:k,data:v,childId:_,attributes:N,isCheck:f})=>{const{toggleBulkDrawer:m,isBulkDrawerOpen:F,closeBulkDrawer:E}=u.useContext(X),{showingTranslateValue:p}=Z(),{tag:R,setTag:O,published:a,register:l,onSubmit:r,errors:t,checked:b,setChecked:M,resetRefTwo:$,handleSubmit:H,setPublished:S,selectedCategory:V,setSelectedCategory:w,defaultCategory:C,setDefaultCategory:z,selectCategoryName:L,setSelectCategoryName:G}=be(x,k,_),I={motionName:"node-motion",motionAppear:!1,onAppearStart:s=>({height:0}),onAppearActive:s=>({height:s.scrollHeight}),onLeaveStart:s=>({height:s.offsetHeight}),onLeaveActive:()=>({height:0})},n=s=>{var y;let j=[];for(let i of s)j.push({title:p(i==null?void 0:i.name),key:i==null?void 0:i.id,children:((y=i==null?void 0:i.children)==null?void 0:y.length)>0&&n(i==null?void 0:i.children)});return j},o=(s,j)=>{var y;return s._id===j?s:(y=s==null?void 0:s.children)==null?void 0:y.reduce((i,h)=>i??o(h,j),void 0)},q=s=>{var y,i;const j=f==null?void 0:f.find(h=>h===s);if((f==null?void 0:f.length)===((i=(y=v[0])==null?void 0:y.children)==null?void 0:i.length))return U("This can't be select as a parent category!");if(j!==void 0)return U("This can't be select as a parent category!");if(s===_)return U("This can't be select as a parent category!");{if(s===void 0)return;M(s);const h=v[0],B=o(h,s);G(p(B==null?void 0:B.name))}},K=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`;return e.jsx(e.Fragment,{children:e.jsxs(ce,{open:F,onClose:E,parent:null,level:null,placement:"right",children:[e.jsx("button",{onClick:m,className:"absolute z-50 text-red-500 hover:bg-red-100 hover:text-gray-700 transition-colors duration-150 bg-white shadow-md mr-6 mt-6 right-0 left-auto w-10 h-10 rounded-full block text-center",children:e.jsx(de,{className:"mx-auto"})}),e.jsxs("div",{className:"flex flex-col w-full h-full justify-between",children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:e.jsx(ge,{title:`Update Selected ${d}`,description:`Apply changes to the selected ${d} from the list`})}),e.jsx(pe.Scrollbars,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:H(r),className:"block",children:[e.jsxs("div",{className:"px-6 pt-8 flex-grow w-full h-full max-h-full pb-40 md:pb-32 lg:pb-32 xl:pb-32",children:[d==="Products"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Categorys"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(ye,{lang:k,selectedCategory:V,setSelectedCategory:w,setDefaultCategory:z})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Default Category"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(Q,{displayValue:"name",isObject:!0,singleSelect:!0,ref:$,hidePlaceholder:!0,onKeyPressFn:function(){},onRemove:function(){},onSearch:function(){},onSelect:s=>z(s),selectedValues:C,options:V,placeholder:"Default Category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Published"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(P,{handleProcess:S,processOption:a}),e.jsx(D,{errorName:t==null?void 0:t.status})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Product Tags"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(ie,{placeholder:"Product Tag (Write then press enter to add new tag )",tags:R,onChange:s=>O(s)})})]})]}),d==="Coupons"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Start Time"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(T.Input,{...l("startTime",{required:"Coupon Validation Start Time"}),label:"Coupon Validation Start Time",name:"startTime",type:"datetime-local",placeholder:"Start Time"}),e.jsx(D,{errorName:t.startTime})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"End Time"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(T.Input,{...l("endTime",{required:"Coupon Validation End Time"}),label:"Coupon Validation End Time",name:"endTime",type:"datetime-local",placeholder:"End Time"}),e.jsx(D,{errorName:t.endTime})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Published"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(P,{handleProcess:S,processOption:a}),e.jsx(D,{errorName:t.published})]})]})]}),d==="Languages"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(P,{title:"",processOption:a,handleProcess:S})})]})}),d==="Currencies"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Enabled"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(P,{title:"",processOption:a,handleProcess:S})})]})}),d==="Categories"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Description"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Y,{register:l,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(D,{errorName:t.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Parent Category"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(T.Input,{readOnly:!0,...l("parent",{required:!1}),name:"parent",value:L||"Home",placeholder:"parent category",type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:K}}),e.jsx(W,{treeData:n(v),selectedKeys:[b],onSelect:s=>q(s[0]),motion:I,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(P,{title:"",processOption:a,handleProcess:S})})]})]}),d==="Child Categories"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Description"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Y,{register:l,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(D,{errorName:t.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Parent Category"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(T.Input,{readOnly:!0,...l("parent",{required:!1}),name:"parent",value:L||"Home",placeholder:"parent category",type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:K}}),e.jsx(W,{treeData:n(v),selectedKeys:[b],onSelect:s=>q(s[0]),motion:I,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(P,{title:"",processOption:a,handleProcess:S})})]})]}),d==="Attributes"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Options"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsxs(T.Select,{name:"option",...l("option",{required:"Option is required!"}),children:[e.jsx("option",{value:"",defaultValue:!0,hidden:!0,children:"Select type"}),e.jsx("option",{value:"Dropdown",children:"Dropdown"}),e.jsx("option",{value:"Radio",children:"Radio"})]}),e.jsx(D,{errorName:t.option})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(P,{title:"",processOption:a,handleProcess:S})})]})]}),d==="Attribute Value(s)"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Change Attribute Group"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsxs(T.Select,{name:"groupName",...l("groupName",{required:!1}),children:[e.jsx("option",{value:"",defaultValue:!0,hidden:!0,children:"Select Attribute Group"}),N==null?void 0:N.map((s,j)=>e.jsx("option",{value:s._id,children:p(s==null?void 0:s.name)},j+1))]}),e.jsx(D,{errorName:t.groupName})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(c,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(P,{title:"",processOption:a,handleProcess:S})})]})]})]}),e.jsxs("div",{className:"fixed bottom-0 w-full right-0 py-4 lg:py-8 px-6 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex bg-gray-50 border-t border-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(T.Button,{onClick:m,className:" text-red-500 hover:bg-red-50 hover:border-red-100 hover:text-red-600 dark:bg-gray-700 dark:border-gray-700 dark:text-gray-500 dark:hover:bg-gray-800 dark:hover:text-red-700",layout:"outline",children:"Cancel"})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(T.Button,{type:"submit",className:"h-12 w-full",children:[" ","Bulk Update ",d]})})]})]})})]})]})})};export{Be as B};
